import{d as J,p as l,c9 as K,r as _,ca as L,c7 as O,c8 as X,o,c as i,i as n,w as G,a as r,V as H,g as d,aJ as C,q as P,a3 as c,b3 as Q,F as R,t as f,be as Y,l as Z,_ as N,__tla as aa}from"./index-12d626d1.js";import{E as ea,__tla as ta}from"./el-image-viewer-fcd5a6f2.js";import{O as sa,__tla as la}from"./aliyun-oss-sdk-e58d75ca.js";import{u as oa,__tla as ia}from"./useMessage-86d9ff5e.js";import{_ as ra}from"./_plugin-vue_export-helper-1b428a4d.js";let S,na=Promise.all([(()=>{try{return aa}catch{}})(),(()=>{try{return ta}catch{}})(),(()=>{try{return la}catch{}})(),(()=>{try{return ia}catch{}})()]).then(async()=>{let y,g,b,w,v,k,x;y={class:"upload-box"},g=["src"],b={key:0},w={key:0},v={key:0},k={key:1,class:"upload-empty"},x={class:"el-upload__tip"},S=ra(J({name:"UploadImg",__name:"UploadImg",props:{modelValue:l.string.def(""),drag:l.bool.def(!0),disabled:l.bool.def(!1),fileSize:l.number.def(5),fileType:l.array.def(["image/jpeg","image/png","image/gif"]),height:l.string.def("150px"),width:l.string.def("150px"),borderradius:l.string.def("8px"),showDelete:l.bool.def(!0),showBtnText:l.bool.def(!0)},emits:["update:modelValue"],setup(t,{emit:q}){K(a=>({27389842:t.width,b3e913aa:t.height,"56f221c2":t.borderradius}));const u=t,{t:m}=Z(),p=oa(),T=_("id-"+L()),h=_(!1),V=q,B=()=>{V("update:modelValue","")},E=_({Authorization:"Bearer "+O(),"tenant-id":X()}),I=()=>{const a=document.querySelector(`#${T.value} .el-upload__input`);a&&a.dispatchEvent(new MouseEvent("click"))},$=async a=>{var e=a.file.name;let s=await j(e,a.file);s=await D(e),V("update:modelValue",s),p.success("\u4E0A\u4F20\u6210\u529F")};let z=new sa({region:"oss-cn-shanghai",accessKeyId:"LTAI5tCXL14qmP6tcMwhz2ft",accessKeySecret:"ZQsGHgjW0SFXR9ss6OqYrJVspjoDor",bucket:"hopai-user-portrait"});const j=async(a,e)=>{try{return await z.put(a,e)}catch{}},D=async a=>{try{return await z.signatureUrl(`${a}`)}catch{}},M=a=>{const e=a.size/1024/1024<u.fileSize,s=u.fileType;return s.includes(a.type)||p.notifyWarning("\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01"),e||p.notifyWarning(`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${u.fileSize}M\uFF01`),s.includes(a.type)&&e},U=()=>{p.notifyError("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01")};return(a,e)=>{const s=N,W=Q,A=ea;return o(),i("div",y,[n(W,{id:r(T),"http-request":$,class:H(["upload",t.drag?"no-border":""]),multiple:!1,"show-file-list":!1,headers:r(E),"before-upload":M,"on-error":U,drag:t.drag,accept:t.fileType.join(",")},{default:G(()=>[t.modelValue?(o(),i(R,{key:0},[d("img",{src:t.modelValue,class:"upload-image"},null,8,g),d("div",{class:"upload-handle",onClick:e[1]||(e[1]=Y(()=>{},["stop"]))},[d("div",{class:"handle-icon",onClick:I},[n(s,{icon:"ep:edit"}),t.showBtnText?(o(),i("span",b,f(r(m)("action.edit")),1)):c("",!0)]),d("div",{class:"handle-icon",onClick:e[0]||(e[0]=F=>h.value=!0)},[n(s,{icon:"ep:zoom-in"}),t.showBtnText?(o(),i("span",w,f(r(m)("action.detail")),1)):c("",!0)]),t.showDelete?(o(),i("div",{key:0,class:"handle-icon",onClick:B},[n(s,{icon:"ep:delete"}),t.showBtnText?(o(),i("span",v,f(r(m)("action.del")),1)):c("",!0)])):c("",!0)])],64)):(o(),i("div",k,[C(a.$slots,"empty",{},()=>[n(s,{icon:"ep:plus"})],!0)]))]),_:3},8,["id","class","headers","drag","accept"]),d("div",x,[C(a.$slots,"tip",{},void 0,!0)]),r(h)?(o(),P(A,{key:0,onClose:e[2]||(e[2]=F=>h.value=!1),"url-list":[t.modelValue]},null,8,["url-list"])):c("",!0)])}}}),[["__scopeId","data-v-3b8219eb"]])});export{S as _,na as __tla};
