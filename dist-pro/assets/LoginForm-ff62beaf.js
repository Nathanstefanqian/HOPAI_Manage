import{d as K,r as d,u as Q,a1 as J,b as W,a,f as X,aQ as Y,A as Z,B as $,a2 as ee,o as N,q as k,w as l,i as e,a3 as ae,P as te,j as E,t as L,l as le,a4 as ne,dk as oe,ae as M,a8 as re,a9 as se,aa as ie,ab as pe,a6 as de,D as me,E as ue,T as ce,ac as _e,n as ge,I as fe,ad as he,__tla as ye}from"./index-75dbf65e.js";import{_ as we,__tla as xe}from"./Verify-3c4d8c46.js";import{_ as be,__tla as Fe}from"./XButton-6d77c831.js";import{E as ve,__tla as Ve}from"./el-link-f7e38500.js";import{u as Ne,L as f,_ as ke,a as Ee,__tla as Le}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-bed36f70.js";import{u as h,__tla as Me}from"./useIcon-79558753.js";import{u as Pe,__tla as Se}from"./useMessage-116f318e.js";import{r as y,__tla as Re}from"./formRules-0babf884.js";import{_ as ze}from"./_plugin-vue_export-helper-1b428a4d.js";let P,Ie=Promise.all([(()=>{try{return ye}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return Ve}catch{}})(),(()=>{try{return Le}catch{}})(),(()=>{try{return Me}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Re}catch{}})()]).then(async()=>{P=ze(K({name:"LoginForm",__name:"LoginForm",setup(Te){const{t:p}=le();Pe();const S=h({icon:"ep:house"}),R=h({icon:"ep:avatar"}),z=h({icon:"ep:lock"}),w=d(),{validForm:I}=Ee(w),{setLoginState:x,getLoginState:T}=Ne(),{currentRoute:U,push:j}=Q(),C=J(),m=d(""),u=d(!1),b=d(),O=d("blockPuzzle"),q=W(()=>a(T)===f.LOGIN),B={tenantName:[y],username:[y],password:[y]},n=X({isShowPassword:!1,captchaEnable:"true",tenantEnable:"true",loginForm:{tenantName:"\u548C\u62CD\u6E90\u7801",username:"admin",password:"admin123",captchaVerification:"",rememberMe:!1}}),F=async()=>{n.captchaEnable==="false"?await V({}):b.value.show()},v=d(),V=async o=>{u.value=!0;try{if(await(async()=>{if(n.tenantEnable==="true"){const i=await he(n.loginForm.tenantName);M(i)}})(),!await I())return;n.loginForm.captchaVerification=o.captchaVerification;const t=await re(n.loginForm);if(!t)return;v.value=se.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),n.loginForm.rememberMe?ie(n.loginForm):pe(),de(t),m.value||(m.value="/"),m.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):j({path:m.value||C.addRouters[0].path})}finally{u.value=!1,v.value.close()}};return Y(()=>U.value,o=>{var t;m.value=(t=o==null?void 0:o.query)==null?void 0:t.redirect},{immediate:!0}),Z(()=>{(()=>{const o=ne();o&&(n.loginForm={...n.loginForm,username:o.username?o.username:n.loginForm.username,password:o.password?o.password:n.loginForm.password,rememberMe:!!o.rememberMe,tenantName:o.tenantName?o.tenantName:n.loginForm.tenantName})})(),(async()=>{const o=location.host,t=await oe(o);t&&(n.loginForm.tenantName=t.name,M(t.id))})()}),(o,t)=>{const i=me,r=ue,c=ce,D=_e,G=ve,_=ge,g=be,A=we,H=fe;return $((N(),k(H,{ref_key:"formLogin",ref:w,model:a(n).loginForm,rules:B,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:l(()=>[e(_,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:l(()=>[e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(i,null,{default:l(()=>[e(ke,{style:{width:"100%"}})]),_:1})]),_:1}),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[a(n).tenantEnable==="true"?(N(),k(i,{key:0,prop:"tenantName"},{default:l(()=>[e(c,{modelValue:a(n).loginForm.tenantName,"onUpdate:modelValue":t[0]||(t[0]=s=>a(n).loginForm.tenantName=s),placeholder:a(p)("login.tenantNamePlaceholder"),"prefix-icon":a(S),link:"",type:"primary"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):ae("",!0)]),_:1}),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(i,{prop:"username"},{default:l(()=>[e(c,{modelValue:a(n).loginForm.username,"onUpdate:modelValue":t[1]||(t[1]=s=>a(n).loginForm.username=s),placeholder:a(p)("login.usernamePlaceholder"),"prefix-icon":a(R)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(i,{prop:"password"},{default:l(()=>[e(c,{modelValue:a(n).loginForm.password,"onUpdate:modelValue":t[2]||(t[2]=s=>a(n).loginForm.password=s),placeholder:a(p)("login.passwordPlaceholder"),"prefix-icon":a(z),"show-password":"",type:"password",onKeyup:t[3]||(t[3]=te(s=>F(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:l(()=>[e(i,null,{default:l(()=>[e(_,{justify:"space-between",style:{width:"100%"}},{default:l(()=>[e(r,{span:6},{default:l(()=>[e(D,{modelValue:a(n).loginForm.rememberMe,"onUpdate:modelValue":t[4]||(t[4]=s=>a(n).loginForm.rememberMe=s)},{default:l(()=>[E(L(a(p)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),e(r,{offset:6,span:12},{default:l(()=>[e(G,{style:{float:"right"},type:"primary"},{default:l(()=>[E(L(a(p)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(i,null,{default:l(()=>[e(g,{loading:a(u),title:a(p)("login.login"),class:"w-[100%]",type:"success",onClick:t[5]||(t[5]=s=>F())},null,8,["loading","title"])]),_:1})]),_:1}),e(A,{ref_key:"verify",ref:b,captchaType:a(O),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:V},null,8,["captchaType"]),e(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(i,null,{default:l(()=>[e(_,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:l(()=>[e(r,{span:8},{default:l(()=>[e(g,{title:a(p)("login.btnMobile"),class:"w-[100%]",onClick:t[6]||(t[6]=s=>a(x)(a(f).MOBILE))},null,8,["title"])]),_:1}),e(r,{span:8}),e(r,{span:8},{default:l(()=>[e(g,{title:a(p)("login.btnRegister"),class:"w-[100%]",onClick:t[7]||(t[7]=s=>a(x)(a(f).REGISTER))},null,8,["title"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[ee,a(q)]])}}}),[["__scopeId","data-v-a9e59b60"]])});export{Ie as __tla,P as default};
