import{d as H,p as i,c9 as N,r as o,c7 as Q,c8 as R,az as W,o as C,c as X,i as u,w as I,a as p,x as Y,V as Z,g as r,aJ as $,q as ee,a3 as ae,bT as m,b3 as se,be as te,_ as le,$ as ie,a0 as re,__tla as ce}from"./index-9a3dc6a8.js";import{E as ne,__tla as de}from"./el-image-viewer-9fcd8ab9.js";import{g as U,O as oe,__tla as ue}from"./index-669fa91c.js";import{u as pe,__tla as me}from"./useMessage-78b6afd0.js";let q,ye=Promise.all([(()=>{try{return ce}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return me}catch{}})()]).then(async()=>{let y,h,v,b,w,k,T,S,x;y=s=>(ie("data-v-fe640eb9"),s=s(),re(),s),h={class:"upload-box"},v={class:"upload-empty"},b=["src"],w=["onClick"],k=y(()=>r("span",null,"\u67E5\u770B",-1)),T=["onClick"],S=y(()=>r("span",null,"\u5220\u9664",-1)),x={class:"el-upload__tip"},q=H({name:"UploadImgs",__name:"UploadImgs",props:{modelValue:{type:Array,required:!0},drag:i.bool.def(!0),disabled:i.bool.def(!1),limit:i.number.def(5),fileSize:i.number.def(5),fileType:i.array.def(["image/jpeg","image/png","image/gif"]),height:i.string.def("150px"),width:i.string.def("150px"),borderradius:i.string.def("8px")},emits:["update:modelValue"],setup(s,{emit:j}){N(e=>({"96241d06":s.borderradius,"3a119632":s.width,"62206e26":s.height}));const K=pe(),d=s,A=o({Authorization:"Bearer "+Q(),"tenant-id":R()}),t=o([]);W(()=>d.modelValue,e=>{e&&(t.value=e)},{deep:!0,immediate:!0});const B=e=>{const a=e.size/1024/1024<d.fileSize,l=d.fileType;return l.includes(e.type)||m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01",type:"warning"}),a||m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${d.fileSize}M\uFF01`,type:"warning"}),l.includes(e.type)&&a},g=j,E=(e,a)=>{e&&(a.url=e.data,g("update:modelValue",t.value),K.success("\u4E0A\u4F20\u6210\u529F"))},J=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01",type:"error"})},L=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u5F53\u524D\u6700\u591A\u53EA\u80FD\u4E0A\u4F20 ${d.limit} \u5F20\u56FE\u7247\uFF0C\u8BF7\u79FB\u9664\u540E\u4E0A\u4F20\uFF01`,type:"warning"})},M=async e=>{let a=e.file.name,l=await O(a,e.file);l=await P(a),t.value[t.value.length-1].url=l,g("update:modelValue",t.value),K.success("\u4E0A\u4F20\u6210\u529F")};let f;(async()=>{let e=await U();f=new oe({region:"oss-cn-shanghai",accessKeyId:e.credentials.accessKeyId,accessKeySecret:e.credentials.accessKeySecret,stsToken:e.credentials.securityToken,bucket:"hopai-product",refreshSTSToken:async()=>(e=await U(),{accessKeyId:e.credentials.accessKeyId,accessKeySecret:e.credentials.accessKeySecret,stsToken:e.credentials.securityToken})})})();const O=async(e,a)=>{try{return await f.put(e,a)}catch{}},P=async e=>{try{return await f.signatureUrl(`${e}`)}catch{}},z=o(""),_=o(!1);return(e,a)=>{const l=le,D=se,F=ne;return C(),X("div",h,[u(D,{"file-list":p(t),"onUpdate:fileList":a[1]||(a[1]=c=>Y(t)?t.value=c:null),accept:s.fileType.join(","),"http-request":M,"before-upload":B,class:Z(["upload",s.drag?"no-border":""]),drag:s.drag,headers:p(A),limit:s.limit,multiple:!0,"on-error":J,"on-exceed":L,"on-success":E,"list-type":"picture-card"},{file:I(({file:c})=>[r("img",{src:c.url,class:"upload-image"},null,8,b),r("div",{class:"upload-handle",onClick:a[0]||(a[0]=te(()=>{},["stop"]))},[r("div",{class:"handle-icon",onClick:G=>{return n=c,z.value=n.url,void(_.value=!0);var n}},[u(l,{icon:"ep:zoom-in"}),k],8,w),r("div",{class:"handle-icon",onClick:G=>{return n=c,t.value=t.value.filter(V=>V.url!==n.url||V.name!==n.name),void g("update:modelValue",t.value);var n}},[u(l,{icon:"ep:delete"}),S],8,T)])]),default:I(()=>[r("div",v,[$(e.$slots,"empty",{},()=>[u(l,{icon:"ep:plus"})],!0)])]),_:3},8,["file-list","accept","class","drag","headers","limit"]),r("div",x,[$(e.$slots,"tip",{},void 0,!0)]),p(_)?(C(),ee(F,{key:0,"url-list":[p(z)],onClose:a[2]||(a[2]=c=>_.value=!1)},null,8,["url-list"])):ae("",!0)])}}})});export{q as _,ye as __tla};
