import{d as E,p as i,cp as F,r as c,cn as G,co as J,aQ as R,o as S,c as W,i as d,w as j,a as p,x as Y,V as Z,g as r,aH as I,q as N,a3 as aa,c7 as m,bl as ea,aP as la,_ as ta,$ as sa,a0 as ia,__tla as ra}from"./index-8d332a1f.js";import{E as na,__tla as oa}from"./el-image-viewer-4a784372.js";import{O as ua,__tla as ca}from"./aliyun-oss-sdk-4bb58d98.js";import{u as da,__tla as pa}from"./useMessage-f7e3e404.js";let T,ma=Promise.all([(()=>{try{return ra}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return ca}catch{}})(),(()=>{try{return pa}catch{}})()]).then(async()=>{let g,y,h,v,b,w,k,x,V;g=l=>(sa("data-v-5a637087"),l=l(),ia(),l),y={class:"upload-box"},h={class:"upload-empty"},v=["src"],b=["onClick"],w=g(()=>r("span",null,"\u67E5\u770B",-1)),k=["onClick"],x=g(()=>r("span",null,"\u5220\u9664",-1)),V={class:"el-upload__tip"},T=E({name:"UploadImgs",__name:"UploadImgs",props:{modelValue:{type:Array,required:!0},drag:i.bool.def(!0),disabled:i.bool.def(!1),limit:i.number.def(5),fileSize:i.number.def(5),fileType:i.array.def(["image/jpeg","image/png","image/gif"]),height:i.string.def("150px"),width:i.string.def("150px"),borderradius:i.string.def("8px")},emits:["update:modelValue"],setup(l,{emit:U}){F(a=>({"7cc774d5":l.borderradius,"03e4448f":l.width,"5ed5537e":l.height}));const z=da(),u=l,A=c({Authorization:"Bearer "+G(),"tenant-id":J()}),t=c([]);R(()=>u.modelValue,a=>{a&&(t.value=a)},{deep:!0,immediate:!0});const L=a=>{const e=a.size/1024/1024<u.fileSize,s=u.fileType;return s.includes(a.type)||m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01",type:"warning"}),e||m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${u.fileSize}M\uFF01`,type:"warning"}),s.includes(a.type)&&e},f=U,M=(a,e)=>{a&&(e.url=a.data,f("update:modelValue",t.value),z.success("\u4E0A\u4F20\u6210\u529F"))},P=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01",type:"error"})},H=()=>{m({title:"\u6E29\u99A8\u63D0\u793A",message:`\u5F53\u524D\u6700\u591A\u53EA\u80FD\u4E0A\u4F20 ${u.limit} \u5F20\u56FE\u7247\uFF0C\u8BF7\u79FB\u9664\u540E\u4E0A\u4F20\uFF01`,type:"warning"})},K=async a=>{let e=a.file.name,s=await O(e,a.file);s=await Q(e),t.value[t.value.length-1].url=s,f("update:modelValue",t.value),z.success("\u4E0A\u4F20\u6210\u529F")};let C=new ua({region:"oss-cn-shanghai",accessKeyId:"LTAI5tCXL14qmP6tcMwhz2ft",accessKeySecret:"ZQsGHgjW0SFXR9ss6OqYrJVspjoDor",bucket:"hopai-user-portrait"});const O=async(a,e)=>{try{return await C.put(a,e)}catch{}},Q=async a=>{try{return await C.signatureUrl(`${a}`)}catch{}},$=c(""),_=c(!1);return(a,e)=>{const s=ta,X=ea,B=na;return S(),W("div",y,[d(X,{"file-list":p(t),"onUpdate:fileList":e[1]||(e[1]=n=>Y(t)?t.value=n:null),accept:l.fileType.join(","),"http-request":K,"before-upload":L,class:Z(["upload",l.drag?"no-border":""]),drag:l.drag,headers:p(A),limit:l.limit,multiple:!0,"on-error":P,"on-exceed":H,"on-success":M,"list-type":"picture-card"},{file:j(({file:n})=>[r("img",{src:n.url,class:"upload-image"},null,8,v),r("div",{class:"upload-handle",onClick:e[0]||(e[0]=la(()=>{},["stop"]))},[r("div",{class:"handle-icon",onClick:D=>{return o=n,$.value=o.url,void(_.value=!0);var o}},[d(s,{icon:"ep:zoom-in"}),w],8,b),r("div",{class:"handle-icon",onClick:D=>{return o=n,t.value=t.value.filter(q=>q.url!==o.url||q.name!==o.name),void f("update:modelValue",t.value);var o}},[d(s,{icon:"ep:delete"}),x],8,k)])]),default:j(()=>[r("div",h,[I(a.$slots,"empty",{},()=>[d(s,{icon:"ep:plus"})],!0)])]),_:3},8,["file-list","accept","class","drag","headers","limit"]),r("div",V,[I(a.$slots,"tip",{},void 0,!0)]),p(_)?(S(),N(B,{key:0,"url-list":[p($)],onClose:e[2]||(e[2]=n=>_.value=!1)},null,8,["url-list"])):aa("",!0)])}}})});export{T as _,ma as __tla};
