import{ap as E,d as ca,r as e,O as ua,o as d,c as U,i as c,w as y,a as _,B as V,g as v,t as ia,x as Z,q as z,j as G,F as na,D as sa,I as oa,H as ma,L as pa,$ as da,a0 as ya,__tla as va}from"./index-7b6f7d71.js";import{_ as ha,__tla as fa}from"./ContentWrap.vue_vue_type_script_setup_true_lang-df5f52c1.js";import{_ as Ma,__tla as xa}from"./index-11d2a228.js";import{_ as ga,__tla as Ua}from"./main.vue_vue_type_script_setup_true_lang-2a49696d.js";import Ia,{__tla as ba}from"./MenuEditor-4ce6dfd7.js";import wa,{__tla as Ta}from"./MenuPreviewer-6a25ab1e.js";import{h as Ca}from"./tree-ebab458e.js";import{u as Ea,__tla as Va}from"./useMessage-74a9519a.js";import{_ as ka}from"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as qa}from"./el-card-dd6e1c0a.js";import{__tla as Da}from"./index-135445ef.js";import{__tla as Sa}from"./main-31929b94.js";import{__tla as $a}from"./TabNews-c9dc3baa.js";import{__tla as Ha}from"./main-21a51a99.js";import{__tla as Oa}from"./el-image-a42f05d6.js";import{__tla as Aa}from"./el-image-viewer-aab9bdab.js";import{__tla as Fa}from"./main-6ee6131c.js";import{__tla as La}from"./index.vue_vue_type_script_setup_true_lang-fbf17cda.js";import{__tla as Na}from"./index-d90a2e88.js";import{__tla as Pa}from"./main-8cc2bd73.js";import{__tla as Ra}from"./main.vue_vue_type_script_setup_true_lang-0cb27616.js";import{__tla as ja}from"./index-c9cf7f39.js";import{__tla as Ba}from"./index-44477f25.js";import{__tla as Wa}from"./formatTime-c0bb357f.js";import{__tla as Za}from"./TabText.vue_vue_type_script_setup_true_lang-8ddef30e.js";import{__tla as za}from"./TabImage-6d7aa0f0.js";import{__tla as Ga}from"./useUpload-377788a5.js";import{__tla as Ja}from"./TabVoice-9164182e.js";import{__tla as Ka}from"./TabVideo-2570b83d.js";import{__tla as Qa}from"./TabMusic.vue_vue_type_script_setup_true_lang-e33b6e06.js";import{__tla as Xa}from"./vuedraggable.umd-cce06e31.js";let J,Ya=Promise.all([(()=>{try{return va}catch{}})(),(()=>{try{return fa}catch{}})(),(()=>{try{return xa}catch{}})(),(()=>{try{return Ua}catch{}})(),(()=>{try{return ba}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return Va}catch{}})(),(()=>{try{return qa}catch{}})(),(()=>{try{return Da}catch{}})(),(()=>{try{return Sa}catch{}})(),(()=>{try{return $a}catch{}})(),(()=>{try{return Ha}catch{}})(),(()=>{try{return Oa}catch{}})(),(()=>{try{return Aa}catch{}})(),(()=>{try{return Fa}catch{}})(),(()=>{try{return La}catch{}})(),(()=>{try{return Na}catch{}})(),(()=>{try{return Pa}catch{}})(),(()=>{try{return Ra}catch{}})(),(()=>{try{return ja}catch{}})(),(()=>{try{return Ba}catch{}})(),(()=>{try{return Wa}catch{}})(),(()=>{try{return Za}catch{}})(),(()=>{try{return za}catch{}})(),(()=>{try{return Ga}catch{}})(),(()=>{try{return Ja}catch{}})(),(()=>{try{return Ka}catch{}})(),(()=>{try{return Qa}catch{}})(),(()=>{try{return Xa}catch{}})()]).then(async()=>{let k,q,D,S,$,H,O,A,F,x;k={class:"clearfix public-account-management"},q={class:"left"},D={class:"weixin-hd"},S={class:"weixin-title"},$={class:"clearfix weixin-menu"},H={class:"save_div"},O={key:0,class:"right"},A={key:1,class:"right"},F=[(g=>(da("data-v-3cc4e775"),g=g(),ya(),g))(()=>v("p",null,"\u8BF7\u9009\u62E9\u83DC\u5355\u914D\u7F6E",-1))],x="__MENU_NOT_SELECTED__",J=ka(ca({name:"MpMenu",__name:"index",setup(g){const o=Ea(),u=e(!1),m=e(-1),L=e(""),i=e([]),h=e(x),I=e(-1),f=e(!1),b=e(!0),n=e({}),l=e({grand:"0",x:0,y:0}),K=e(!1),Q=(t,a)=>{m.value=t,L.value=a,w()},w=async()=>{u.value=!1;try{const t=await(r=>E.get({url:"/mp/menu/list?accountId="+r}))(m.value),a=X(t);i.value=Ca(a,"id")}finally{u.value=!1}},X=t=>{if(!t)return[];const a=[];return t.forEach(r=>{const p={...r};p.reply={type:r.replyMessageType,accountId:r.accountId,content:r.replyContent,mediaId:r.replyMediaId,url:r.replyMediaUrl,title:r.replyTitle,description:r.replyDescription,thumbMediaId:r.replyThumbMediaId,thumbMediaUrl:r.replyThumbMediaUrl,articles:r.replyArticles,musicUrl:r.replyMusicUrl,hqMusicUrl:r.replyHqMusicUrl},a.push(p)}),a},Y=()=>{h.value=x,I.value=-1,f.value=!1,n.value={},l.value={grand:"0",x:0,y:0},K.value=!1},aa=async()=>{var t;try{await o.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417?"),l.value.grand==="1"?i.value.splice(l.value.x,1):l.value.grand==="2"&&((t=i.value[l.value.x].children)==null||t.splice(l.value.y,1)),o.notifySuccess("\u5220\u9664\u6210\u529F"),n.value={},f.value=!1,h.value=x}catch{}},ta=async()=>{try{await o.confirm("\u786E\u5B9A\u8981\u4FDD\u5B58\u5417?"),u.value=!0,await((t,a)=>E.post({url:"/mp/menu/save",data:{accountId:t,menus:a}}))(m.value,la()),w(),o.notifySuccess("\u53D1\u5E03\u6210\u529F")}finally{u.value=!1}},ra=async()=>{try{await o.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417?"),u.value=!0,await(t=>E.delete({url:"/mp/menu/delete?accountId="+t}))(m.value),Y(),w(),o.notifySuccess("\u6E05\u7A7A\u6210\u529F")}finally{u.value=!1}},la=()=>{const t=[];return i.value.forEach(a=>{const r=N(a);t.push(r),!a.children||a.children.length<=0||(r.children=[],a.children.forEach(p=>{r.children.push(N(p))}))}),t},N=t=>{let a={...t,children:void 0,reply:void 0};return a.replyMessageType=t.reply.type,a.replyContent=t.reply.content,a.replyMediaId=t.reply.mediaId,a.replyMediaUrl=t.reply.url,a.replyTitle=t.reply.title,a.replyDescription=t.reply.description,a.replyThumbMediaId=t.reply.thumbMediaId,a.replyThumbMediaUrl=t.reply.thumbMediaUrl,a.replyArticles=t.reply.articles,a.replyMusicUrl=t.reply.musicUrl,a.replyHqMusicUrl=t.reply.hqMusicUrl,a};return(t,a)=>{const r=Ma,p=sa,ea=oa,P=ha,R=ma,j=ua("hasPermi"),_a=pa;return d(),U(na,null,[c(r,{title:"\u516C\u4F17\u53F7\u83DC\u5355",url:"https://doc.iocoder.cn/mp/menu/"}),c(P,null,{default:y(()=>[c(ea,{class:"-mb-15px",ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:y(()=>[c(p,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:y(()=>[c(_(ga),{onChange:Q})]),_:1})]),_:1},512)]),_:1}),c(P,null,{default:y(()=>[V((d(),U("div",k,[v("div",q,[v("div",D,[v("div",S,ia(_(L)),1)]),v("div",$,[c(wa,{modelValue:_(i),"onUpdate:modelValue":a[0]||(a[0]=s=>Z(i)?i.value=s:null),"account-id":_(m),"active-index":_(h),"parent-index":_(I),onMenuClicked:a[1]||(a[1]=(s,T)=>((C,M)=>{f.value=!0,n.value=C,l.value.grand="1",l.value.x=M,b.value=!0,h.value=`${M}`,I.value=M})(s,T)),onSubmenuClicked:a[2]||(a[2]=(s,T,C)=>((M,B,W)=>{f.value=!0,n.value=M,l.value.grand="2",l.value.x=B,l.value.y=W,b.value=!1,h.value=`${B}-${W}`})(s,T,C))},null,8,["modelValue","account-id","active-index","parent-index"])]),v("div",H,[V((d(),z(R,{class:"save_btn",type:"success",onClick:ta},{default:y(()=>[G("\u4FDD\u5B58\u5E76\u53D1\u5E03\u83DC\u5355")]),_:1})),[[j,["mp:menu:save"]]]),V((d(),z(R,{class:"save_btn",type:"danger",onClick:ra},{default:y(()=>[G("\u6E05\u7A7A\u83DC\u5355")]),_:1})),[[j,["mp:menu:delete"]]])])]),_(f)?(d(),U("div",O,[c(Ia,{"account-id":_(m),"is-parent":_(b),modelValue:_(n),"onUpdate:modelValue":a[3]||(a[3]=s=>Z(n)?n.value=s:null),onDelete:aa},null,8,["account-id","is-parent","modelValue"])])):(d(),U("div",A,F))])),[[_a,_(u)]])]),_:1})],64)}}}),[["__scopeId","data-v-3cc4e775"]])});export{Ya as __tla,J as default};
